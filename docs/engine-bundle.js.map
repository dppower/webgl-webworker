{"version":3,"file":"engine-bundle.js","sources":["../build/game-engine/vec3.js","../build/game-engine/game-object.js","../build/game-engine/quaternion.js","../build/game-engine/mat4.js","../build/game-engine/transform.js","../build/game-engine/input-state.js","../build/game-engine/game-engine.js","../node_modules/rxjs/_esm5/util/root.js","../node_modules/rxjs/_esm5/util/isFunction.js","../node_modules/rxjs/_esm5/util/isArray.js","../node_modules/rxjs/_esm5/util/errorObject.js","../node_modules/rxjs/_esm5/util/tryCatch.js","../node_modules/rxjs/_esm5/util/UnsubscriptionError.js","../node_modules/rxjs/_esm5/Subscription.js","../node_modules/rxjs/_esm5/util/isObject.js","../node_modules/rxjs/_esm5/Observer.js","../node_modules/rxjs/_esm5/symbol/rxSubscriber.js","../node_modules/rxjs/_esm5/Subscriber.js","../node_modules/rxjs/_esm5/symbol/observable.js","../node_modules/rxjs/_esm5/util/noop.js","../node_modules/rxjs/_esm5/Observable.js","../node_modules/rxjs/_esm5/util/toSubscriber.js","../node_modules/rxjs/_esm5/util/pipe.js","../node_modules/rxjs/_esm5/util/ObjectUnsubscribedError.js","../node_modules/rxjs/_esm5/SubjectSubscription.js","../node_modules/rxjs/_esm5/Subject.js","../build/game-engine/worker-messenger.js","../build/game-engine/game-state.js","../build/game-engine/game-camera.js","../build/game-engine/main.js"],"sourcesContent":["var Vec3 = (function () {\r\n    function Vec3(x, y, z) {\r\n        if (x === void 0) { x = 0.0; }\r\n        if (y === void 0) { y = 0.0; }\r\n        if (z === void 0) { z = 0.0; }\r\n        this.vector_ = new Float32Array([x, y, z]);\r\n    }\r\n    ;\r\n    Object.defineProperty(Vec3.prototype, \"x\", {\r\n        get: function () { return this.vector_[0]; },\r\n        set: function (value) { this.vector_[0] = value; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ;\r\n    Object.defineProperty(Vec3.prototype, \"y\", {\r\n        get: function () { return this.vector_[1]; },\r\n        set: function (value) { this.vector_[1] = value; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ;\r\n    Object.defineProperty(Vec3.prototype, \"z\", {\r\n        get: function () { return this.vector_[2]; },\r\n        set: function (value) { this.vector_[2] = value; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ;\r\n    ;\r\n    ;\r\n    ;\r\n    Object.defineProperty(Vec3.prototype, \"array\", {\r\n        get: function () { return this.vector_; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ;\r\n    Object.defineProperty(Vec3.prototype, \"length\", {\r\n        get: function () {\r\n            return Math.sqrt(Math.pow(this.x, 2) + Math.pow(this.y, 2) + Math.pow(this.z, 2));\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ;\r\n    Vec3.dot = function (a, b) {\r\n        return a.x * b.x + a.y * b.y + a.z * b.z;\r\n    };\r\n    ;\r\n    Vec3.cross = function (a, b, out) {\r\n        out.x = (a.y * b.z) - (a.z * b.y);\r\n        out.y = (a.z * b.x) - (a.x * b.z);\r\n        out.z = (a.x * b.y) - (a.y * b.x);\r\n    };\r\n    ;\r\n    Vec3.prototype.normalise = function () {\r\n        var length = this.length;\r\n        if (length > 0) {\r\n            var factor = 1.0 / length;\r\n            Vec3.scale(factor, this, this);\r\n        }\r\n    };\r\n    ;\r\n    Vec3.add = function (a, b, out) {\r\n        out.x = a.x + b.x;\r\n        out.y = a.y + b.y;\r\n        out.z = a.z + b.z;\r\n    };\r\n    ;\r\n    Vec3.subtract = function (a, b, out) {\r\n        out.x = a.x - b.x;\r\n        out.y = a.y - b.y;\r\n        out.z = a.z - b.z;\r\n    };\r\n    ;\r\n    Vec3.scale = function (s, a, out) {\r\n        out.x = a.x * s;\r\n        out.y = a.y * s;\r\n        out.z = a.z * s;\r\n    };\r\n    ;\r\n    Vec3.prototype.copy = function (a) {\r\n        for (var i in this.vector_) {\r\n            this.vector_[i] = a.array[i];\r\n        }\r\n    };\r\n    ;\r\n    return Vec3;\r\n}());\r\nexport { Vec3 };\r\n;\r\n//# sourceMappingURL=vec3.js.map","import { Vec3 } from \"./vec3\";\r\nvar GameObject = (function () {\r\n    function GameObject(transform_) {\r\n        this.transform_ = transform_;\r\n        this.isActive = true;\r\n    }\r\n    ;\r\n    GameObject.prototype.update = function (dt, inputs) {\r\n        if (inputs.left) {\r\n            var dx = 0.005 * dt * inputs.delta.x;\r\n            this.transform_.rotate(new Vec3(0.0, 0.0, 1.0), dx);\r\n        }\r\n        return this.transform_.transform;\r\n    };\r\n    ;\r\n    GameObject.prototype.markInactive = function () {\r\n        this.isActive = false;\r\n    };\r\n    ;\r\n    return GameObject;\r\n}());\r\nexport { GameObject };\r\n;\r\n//# sourceMappingURL=game-object.js.map","import { Vec3 } from \"./vec3\";\r\nvar Quaternion = (function () {\r\n    function Quaternion(axis, angle) {\r\n        if (axis === void 0) { axis = new Vec3(); }\r\n        if (angle === void 0) { angle = 0.0; }\r\n        var phi = angle * Math.PI / 360.0;\r\n        this.v_ = new Vec3();\r\n        Vec3.scale(Math.sin(phi), axis, this.v_);\r\n        this.w_ = Math.cos(phi);\r\n    }\r\n    ;\r\n    Object.defineProperty(Quaternion.prototype, \"x\", {\r\n        get: function () {\r\n            return this.v_.x;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ;\r\n    Object.defineProperty(Quaternion.prototype, \"y\", {\r\n        get: function () {\r\n            return this.v_.y;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ;\r\n    Object.defineProperty(Quaternion.prototype, \"z\", {\r\n        get: function () {\r\n            return this.v_.z;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ;\r\n    Object.defineProperty(Quaternion.prototype, \"w\", {\r\n        get: function () {\r\n            return this.w_;\r\n        },\r\n        set: function (value) {\r\n            this.w_ = value;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ;\r\n    Object.defineProperty(Quaternion.prototype, \"v\", {\r\n        get: function () {\r\n            return this.v_;\r\n        },\r\n        set: function (v) {\r\n            this.v_.copy(v);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ;\r\n    Object.defineProperty(Quaternion.prototype, \"length\", {\r\n        get: function () {\r\n            return Math.sqrt(Math.pow(this.x, 2) + Math.pow(this.y, 2) + Math.pow(this.z, 2) + Math.pow(this.w, 2));\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ;\r\n    ;\r\n    ;\r\n    Quaternion.prototype.conjugate = function () {\r\n        var c = new Quaternion();\r\n        Vec3.scale(-1.0, this.v_, c.v);\r\n        c.w = this.w_;\r\n        return c;\r\n    };\r\n    ;\r\n    Quaternion.prototype.rotate = function (v) {\r\n        var p = new Quaternion();\r\n        p.w = 0.0;\r\n        p.v = v;\r\n        var r = this.multiply(p).multiply(this.conjugate());\r\n        return r;\r\n    };\r\n    ;\r\n    Quaternion.prototype.normalise = function () {\r\n        var factor = 1.0 / this.length;\r\n        Vec3.scale(factor, this.v, this.v);\r\n        this.w *= factor;\r\n    };\r\n    Quaternion.prototype.multiply = function (q) {\r\n        this.normalise();\r\n        q.normalise();\r\n        var r = new Quaternion();\r\n        r.w = this.w * q.w - Vec3.dot(this.v_, q.v);\r\n        var v = new Vec3();\r\n        Vec3.scale(q.w, this.v_, v);\r\n        Vec3.add(r.v, v, r.v);\r\n        Vec3.scale(this.w, q.v, v);\r\n        Vec3.add(r.v, v, r.v);\r\n        Vec3.cross(this.v_, q.v, v);\r\n        Vec3.add(r.v, v, r.v);\r\n        return r;\r\n    };\r\n    ;\r\n    return Quaternion;\r\n}());\r\nexport { Quaternion };\r\n//# sourceMappingURL=quaternion.js.map","var Mat4 = (function () {\r\n    function Mat4() {\r\n        this.matrix_ = new Float32Array(16);\r\n        this.identity();\r\n    }\r\n    ;\r\n    Object.defineProperty(Mat4.prototype, \"array\", {\r\n        get: function () {\r\n            return this.matrix_;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ;\r\n    Mat4.prototype.identity = function () {\r\n        this.matrix_[0] = 1.0;\r\n        this.matrix_[1] = 0;\r\n        this.matrix_[2] = 0;\r\n        this.matrix_[3] = 0;\r\n        this.matrix_[4] = 0;\r\n        this.matrix_[5] = 1.0;\r\n        this.matrix_[6] = 0;\r\n        this.matrix_[7] = 0;\r\n        this.matrix_[8] = 0;\r\n        this.matrix_[9] = 0;\r\n        this.matrix_[10] = 1.0;\r\n        this.matrix_[11] = 0;\r\n        this.matrix_[12] = 0;\r\n        this.matrix_[13] = 0;\r\n        this.matrix_[14] = 0;\r\n        this.matrix_[15] = 1.0;\r\n    };\r\n    ;\r\n    Mat4.multiply = function (a, b, out) {\r\n        var a11 = a.array[0], a12 = a.array[1], a13 = a.array[2], a14 = a.array[3], a21 = a.array[4], a22 = a.array[5], a23 = a.array[6], a24 = a.array[7], a31 = a.array[8], a32 = a.array[9], a33 = a.array[10], a34 = a.array[11], a41 = a.array[12], a42 = a.array[13], a43 = a.array[14], a44 = a.array[15];\r\n        for (var i = 0; i < 16; i += 4) {\r\n            var b1 = b.array[i], b2 = b.array[i + 1], b3 = b.array[i + 2], b4 = b.array[i + 3];\r\n            out.array[i] = b1 * a11 + b2 * a21 + b3 * a31 + b4 * a41;\r\n            out.array[i + 1] = b1 * a12 + b2 * a22 + b3 * a32 + b4 * a42;\r\n            out.array[i + 2] = b1 * a13 + b2 * a23 + b3 * a33 + b4 * a43;\r\n            out.array[i + 3] = b1 * a14 + b2 * a24 + b3 * a34 + b4 * a44;\r\n        }\r\n    };\r\n    ;\r\n    Mat4.prototype.rotate = function (q) {\r\n        var r = new Mat4();\r\n        q.normalise();\r\n        var n = 2.0;\r\n        var wx = n * q.w * q.x;\r\n        var wy = n * q.w * q.y;\r\n        var wz = n * q.w * q.z;\r\n        var xx = n * q.x * q.x;\r\n        var yy = n * q.y * q.y;\r\n        var zz = n * q.z * q.z;\r\n        var xy = n * q.x * q.y;\r\n        var xz = n * q.x * q.z;\r\n        var yz = n * q.y * q.z;\r\n        r.array[0] = 1.0 - (yy + zz);\r\n        r.array[1] = xy + wz;\r\n        r.array[2] = xz - wy;\r\n        r.array[4] = xy - wz;\r\n        r.array[5] = 1.0 - (xx + zz);\r\n        r.array[6] = yz + wx;\r\n        r.array[8] = xz + wy;\r\n        r.array[9] = yz - wx;\r\n        r.array[10] = 1.0 - (xx + yy);\r\n        Mat4.multiply(this, r, this);\r\n    };\r\n    ;\r\n    Mat4.prototype.scale = function (v) {\r\n        var s = new Mat4();\r\n        s.array[0] = v.x;\r\n        s.array[5] = v.y;\r\n        s.array[10] = v.z;\r\n        Mat4.multiply(this, s, this);\r\n    };\r\n    ;\r\n    Mat4.prototype.translate = function (v) {\r\n        var t = new Mat4();\r\n        t.array[12] = v.x;\r\n        t.array[13] = v.y;\r\n        t.array[14] = v.z;\r\n        Mat4.multiply(this, t, this);\r\n    };\r\n    ;\r\n    return Mat4;\r\n}());\r\nexport { Mat4 };\r\n;\r\n//# sourceMappingURL=mat4.js.map","import { Vec3 } from \"./vec3\";\r\nimport { Quaternion } from \"./quaternion\";\r\nimport { Mat4 } from \"./mat4\";\r\nvar Transform = (function () {\r\n    function Transform(position_, scale_, orientation_) {\r\n        if (position_ === void 0) { position_ = new Vec3(); }\r\n        if (scale_ === void 0) { scale_ = new Vec3(1.0, 1.0, 1.0); }\r\n        if (orientation_ === void 0) { orientation_ = new Quaternion(); }\r\n        this.position_ = position_;\r\n        this.scale_ = scale_;\r\n        this.orientation_ = orientation_;\r\n        this.transform_ = new Mat4();\r\n    }\r\n    Object.defineProperty(Transform.prototype, \"transform\", {\r\n        get: function () {\r\n            this.transform_.identity();\r\n            this.transform_.rotate(this.orientation_);\r\n            this.transform_.translate(this.position_);\r\n            this.transform_.scale(this.scale_);\r\n            return this.transform_.array;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ;\r\n    Transform.prototype.scale = function (v) {\r\n        this.scale_.copy(v);\r\n    };\r\n    ;\r\n    Transform.prototype.translate = function (v) {\r\n        Vec3.add(this.position_, v, this.position_);\r\n    };\r\n    ;\r\n    Transform.prototype.rotate = function (vec, angle) {\r\n        var q = new Quaternion(vec, angle);\r\n        var r = this.orientation_.multiply(q);\r\n        this.orientation_ = r;\r\n    };\r\n    ;\r\n    ;\r\n    return Transform;\r\n}());\r\nexport { Transform };\r\n;\r\n//# sourceMappingURL=transform.js.map","var InputState = (function () {\r\n    function InputState() {\r\n    }\r\n    return InputState;\r\n}());\r\nexport { InputState };\r\n;\r\n//# sourceMappingURL=input-state.js.map","import { GameObject } from \"./game-object\";\r\nimport { Transform } from \"./transform\";\r\nimport { InputState } from \"./input-state\";\r\nimport { Quaternion } from \"./quaternion\";\r\nimport { Vec3 } from \"./vec3\";\r\nvar GameEngine = (function () {\r\n    function GameEngine(messenger_, gameState_) {\r\n        var _this = this;\r\n        this.messenger_ = messenger_;\r\n        this.gameState_ = gameState_;\r\n        this.current_inputs_ = new InputState();\r\n        this.inputs_subscription = this.messenger_.getInputs().subscribe(function (inputs) {\r\n            _this.current_inputs_ = inputs;\r\n        });\r\n    }\r\n    ;\r\n    GameEngine.prototype.Start = function () {\r\n        var testObject = new GameObject(new Transform(new Vec3(), new Vec3(1, 1, 1), new Quaternion(new Vec3(1.0, 0, 0), -90)));\r\n        this.gameState_.addNewObject(testObject);\r\n    };\r\n    ;\r\n    GameEngine.prototype.Update = function (dt) {\r\n        var state = this.gameState_.updateObjects(dt, this.current_inputs_);\r\n        this.messenger_.pushChanges(state);\r\n    };\r\n    ;\r\n    GameEngine.prototype.dispose = function () {\r\n        this.inputs_subscription.unsubscribe();\r\n    };\r\n    ;\r\n    return GameEngine;\r\n}());\r\nexport { GameEngine };\r\n;\r\n//# sourceMappingURL=game-engine.js.map","// CommonJS / Node have global context exposed as \"global\" variable.\n// We don't want to include the whole node.d.ts this this compilation unit so we'll just fake\n// the global \"global\" var for now.\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nvar __window = typeof window !== 'undefined' && window;\nvar __self = typeof self !== 'undefined' && typeof WorkerGlobalScope !== 'undefined' &&\n    self instanceof WorkerGlobalScope && self;\nvar __global = typeof global !== 'undefined' && global;\nvar _root = __window || __global || __self;\n// Workaround Closure Compiler restriction: The body of a goog.module cannot use throw.\n// This is needed when used with angular/tsickle which inserts a goog.module statement.\n// Wrap in IIFE\n/*@__PURE__*/ (function () {\n    if (!_root) {\n        throw new Error('RxJS could not find any global context (window, self, global)');\n    }\n})();\nexport { _root as root };\n//# sourceMappingURL=root.js.map \n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function isFunction(x) {\n    return typeof x === 'function';\n}\n//# sourceMappingURL=isFunction.js.map \n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var isArray = Array.isArray || (function (x) { return x && typeof x.length === 'number'; });\n//# sourceMappingURL=isArray.js.map \n","// typeof any so that it we don't have to cast when comparing a result to the error object\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var errorObject = { e: {} };\n//# sourceMappingURL=errorObject.js.map \n","/** PURE_IMPORTS_START ._errorObject PURE_IMPORTS_END */\nimport { errorObject } from './errorObject';\nvar tryCatchTarget;\nfunction tryCatcher() {\n    try {\n        return tryCatchTarget.apply(this, arguments);\n    }\n    catch (e) {\n        errorObject.e = e;\n        return errorObject;\n    }\n}\nexport function tryCatch(fn) {\n    tryCatchTarget = fn;\n    return tryCatcher;\n}\n;\n//# sourceMappingURL=tryCatch.js.map \n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b)\n        if (b.hasOwnProperty(p))\n            d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\n/**\n * An error thrown when one or more errors have occurred during the\n * `unsubscribe` of a {@link Subscription}.\n */\nexport var UnsubscriptionError = /*@__PURE__*/ (/*@__PURE__*/ function (_super) {\n    __extends(UnsubscriptionError, _super);\n    function UnsubscriptionError(errors) {\n        _super.call(this);\n        this.errors = errors;\n        var err = Error.call(this, errors ?\n            errors.length + \" errors occurred during unsubscription:\\n  \" + errors.map(function (err, i) { return ((i + 1) + \") \" + err.toString()); }).join('\\n  ') : '');\n        this.name = err.name = 'UnsubscriptionError';\n        this.stack = err.stack;\n        this.message = err.message;\n    }\n    return UnsubscriptionError;\n}(Error));\n//# sourceMappingURL=UnsubscriptionError.js.map \n","/** PURE_IMPORTS_START ._util_isArray,._util_isObject,._util_isFunction,._util_tryCatch,._util_errorObject,._util_UnsubscriptionError PURE_IMPORTS_END */\nimport { isArray } from './util/isArray';\nimport { isObject } from './util/isObject';\nimport { isFunction } from './util/isFunction';\nimport { tryCatch } from './util/tryCatch';\nimport { errorObject } from './util/errorObject';\nimport { UnsubscriptionError } from './util/UnsubscriptionError';\n/**\n * Represents a disposable resource, such as the execution of an Observable. A\n * Subscription has one important method, `unsubscribe`, that takes no argument\n * and just disposes the resource held by the subscription.\n *\n * Additionally, subscriptions may be grouped together through the `add()`\n * method, which will attach a child Subscription to the current Subscription.\n * When a Subscription is unsubscribed, all its children (and its grandchildren)\n * will be unsubscribed as well.\n *\n * @class Subscription\n */\nexport var Subscription = /*@__PURE__*/ (/*@__PURE__*/ function () {\n    /**\n     * @param {function(): void} [unsubscribe] A function describing how to\n     * perform the disposal of resources when the `unsubscribe` method is called.\n     */\n    function Subscription(unsubscribe) {\n        /**\n         * A flag to indicate whether this Subscription has already been unsubscribed.\n         * @type {boolean}\n         */\n        this.closed = false;\n        this._parent = null;\n        this._parents = null;\n        this._subscriptions = null;\n        if (unsubscribe) {\n            this._unsubscribe = unsubscribe;\n        }\n    }\n    /**\n     * Disposes the resources held by the subscription. May, for instance, cancel\n     * an ongoing Observable execution or cancel any other type of work that\n     * started when the Subscription was created.\n     * @return {void}\n     */\n    Subscription.prototype.unsubscribe = function () {\n        var hasErrors = false;\n        var errors;\n        if (this.closed) {\n            return;\n        }\n        var _a = this, _parent = _a._parent, _parents = _a._parents, _unsubscribe = _a._unsubscribe, _subscriptions = _a._subscriptions;\n        this.closed = true;\n        this._parent = null;\n        this._parents = null;\n        // null out _subscriptions first so any child subscriptions that attempt\n        // to remove themselves from this subscription will noop\n        this._subscriptions = null;\n        var index = -1;\n        var len = _parents ? _parents.length : 0;\n        // if this._parent is null, then so is this._parents, and we\n        // don't have to remove ourselves from any parent subscriptions.\n        while (_parent) {\n            _parent.remove(this);\n            // if this._parents is null or index >= len,\n            // then _parent is set to null, and the loop exits\n            _parent = ++index < len && _parents[index] || null;\n        }\n        if (isFunction(_unsubscribe)) {\n            var trial = tryCatch(_unsubscribe).call(this);\n            if (trial === errorObject) {\n                hasErrors = true;\n                errors = errors || (errorObject.e instanceof UnsubscriptionError ?\n                    flattenUnsubscriptionErrors(errorObject.e.errors) : [errorObject.e]);\n            }\n        }\n        if (isArray(_subscriptions)) {\n            index = -1;\n            len = _subscriptions.length;\n            while (++index < len) {\n                var sub = _subscriptions[index];\n                if (isObject(sub)) {\n                    var trial = tryCatch(sub.unsubscribe).call(sub);\n                    if (trial === errorObject) {\n                        hasErrors = true;\n                        errors = errors || [];\n                        var err = errorObject.e;\n                        if (err instanceof UnsubscriptionError) {\n                            errors = errors.concat(flattenUnsubscriptionErrors(err.errors));\n                        }\n                        else {\n                            errors.push(err);\n                        }\n                    }\n                }\n            }\n        }\n        if (hasErrors) {\n            throw new UnsubscriptionError(errors);\n        }\n    };\n    /**\n     * Adds a tear down to be called during the unsubscribe() of this\n     * Subscription.\n     *\n     * If the tear down being added is a subscription that is already\n     * unsubscribed, is the same reference `add` is being called on, or is\n     * `Subscription.EMPTY`, it will not be added.\n     *\n     * If this subscription is already in an `closed` state, the passed\n     * tear down logic will be executed immediately.\n     *\n     * @param {TeardownLogic} teardown The additional logic to execute on\n     * teardown.\n     * @return {Subscription} Returns the Subscription used or created to be\n     * added to the inner subscriptions list. This Subscription can be used with\n     * `remove()` to remove the passed teardown logic from the inner subscriptions\n     * list.\n     */\n    Subscription.prototype.add = function (teardown) {\n        if (!teardown || (teardown === Subscription.EMPTY)) {\n            return Subscription.EMPTY;\n        }\n        if (teardown === this) {\n            return this;\n        }\n        var subscription = teardown;\n        switch (typeof teardown) {\n            case 'function':\n                subscription = new Subscription(teardown);\n            case 'object':\n                if (subscription.closed || typeof subscription.unsubscribe !== 'function') {\n                    return subscription;\n                }\n                else if (this.closed) {\n                    subscription.unsubscribe();\n                    return subscription;\n                }\n                else if (typeof subscription._addParent !== 'function' /* quack quack */) {\n                    var tmp = subscription;\n                    subscription = new Subscription();\n                    subscription._subscriptions = [tmp];\n                }\n                break;\n            default:\n                throw new Error('unrecognized teardown ' + teardown + ' added to Subscription.');\n        }\n        var subscriptions = this._subscriptions || (this._subscriptions = []);\n        subscriptions.push(subscription);\n        subscription._addParent(this);\n        return subscription;\n    };\n    /**\n     * Removes a Subscription from the internal list of subscriptions that will\n     * unsubscribe during the unsubscribe process of this Subscription.\n     * @param {Subscription} subscription The subscription to remove.\n     * @return {void}\n     */\n    Subscription.prototype.remove = function (subscription) {\n        var subscriptions = this._subscriptions;\n        if (subscriptions) {\n            var subscriptionIndex = subscriptions.indexOf(subscription);\n            if (subscriptionIndex !== -1) {\n                subscriptions.splice(subscriptionIndex, 1);\n            }\n        }\n    };\n    Subscription.prototype._addParent = function (parent) {\n        var _a = this, _parent = _a._parent, _parents = _a._parents;\n        if (!_parent || _parent === parent) {\n            // If we don't have a parent, or the new parent is the same as the\n            // current parent, then set this._parent to the new parent.\n            this._parent = parent;\n        }\n        else if (!_parents) {\n            // If there's already one parent, but not multiple, allocate an Array to\n            // store the rest of the parent Subscriptions.\n            this._parents = [parent];\n        }\n        else if (_parents.indexOf(parent) === -1) {\n            // Only add the new parent to the _parents list if it's not already there.\n            _parents.push(parent);\n        }\n    };\n    Subscription.EMPTY = (function (empty) {\n        empty.closed = true;\n        return empty;\n    }(new Subscription()));\n    return Subscription;\n}());\nfunction flattenUnsubscriptionErrors(errors) {\n    return errors.reduce(function (errs, err) { return errs.concat((err instanceof UnsubscriptionError) ? err.errors : err); }, []);\n}\n//# sourceMappingURL=Subscription.js.map \n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function isObject(x) {\n    return x != null && typeof x === 'object';\n}\n//# sourceMappingURL=isObject.js.map \n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport var empty = {\n    closed: true,\n    next: function (value) { },\n    error: function (err) { throw err; },\n    complete: function () { }\n};\n//# sourceMappingURL=Observer.js.map \n","/** PURE_IMPORTS_START .._util_root PURE_IMPORTS_END */\nimport { root } from '../util/root';\nvar Symbol = root.Symbol;\nexport var rxSubscriber = (typeof Symbol === 'function' && typeof Symbol.for === 'function') ?\n    /*@__PURE__*/ Symbol.for('rxSubscriber') : '@@rxSubscriber';\n/**\n * @deprecated use rxSubscriber instead\n */\nexport var $$rxSubscriber = rxSubscriber;\n//# sourceMappingURL=rxSubscriber.js.map \n","/** PURE_IMPORTS_START ._util_isFunction,._Subscription,._Observer,._symbol_rxSubscriber PURE_IMPORTS_END */\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b)\n        if (b.hasOwnProperty(p))\n            d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nimport { isFunction } from './util/isFunction';\nimport { Subscription } from './Subscription';\nimport { empty as emptyObserver } from './Observer';\nimport { rxSubscriber as rxSubscriberSymbol } from './symbol/rxSubscriber';\n/**\n * Implements the {@link Observer} interface and extends the\n * {@link Subscription} class. While the {@link Observer} is the public API for\n * consuming the values of an {@link Observable}, all Observers get converted to\n * a Subscriber, in order to provide Subscription-like capabilities such as\n * `unsubscribe`. Subscriber is a common type in RxJS, and crucial for\n * implementing operators, but it is rarely used as a public API.\n *\n * @class Subscriber<T>\n */\nexport var Subscriber = /*@__PURE__*/ (/*@__PURE__*/ function (_super) {\n    __extends(Subscriber, _super);\n    /**\n     * @param {Observer|function(value: T): void} [destinationOrNext] A partially\n     * defined Observer or a `next` callback function.\n     * @param {function(e: ?any): void} [error] The `error` callback of an\n     * Observer.\n     * @param {function(): void} [complete] The `complete` callback of an\n     * Observer.\n     */\n    function Subscriber(destinationOrNext, error, complete) {\n        _super.call(this);\n        this.syncErrorValue = null;\n        this.syncErrorThrown = false;\n        this.syncErrorThrowable = false;\n        this.isStopped = false;\n        switch (arguments.length) {\n            case 0:\n                this.destination = emptyObserver;\n                break;\n            case 1:\n                if (!destinationOrNext) {\n                    this.destination = emptyObserver;\n                    break;\n                }\n                if (typeof destinationOrNext === 'object') {\n                    if (destinationOrNext instanceof Subscriber) {\n                        this.syncErrorThrowable = destinationOrNext.syncErrorThrowable;\n                        this.destination = destinationOrNext;\n                        this.destination.add(this);\n                    }\n                    else {\n                        this.syncErrorThrowable = true;\n                        this.destination = new SafeSubscriber(this, destinationOrNext);\n                    }\n                    break;\n                }\n            default:\n                this.syncErrorThrowable = true;\n                this.destination = new SafeSubscriber(this, destinationOrNext, error, complete);\n                break;\n        }\n    }\n    Subscriber.prototype[rxSubscriberSymbol] = function () { return this; };\n    /**\n     * A static factory for a Subscriber, given a (potentially partial) definition\n     * of an Observer.\n     * @param {function(x: ?T): void} [next] The `next` callback of an Observer.\n     * @param {function(e: ?any): void} [error] The `error` callback of an\n     * Observer.\n     * @param {function(): void} [complete] The `complete` callback of an\n     * Observer.\n     * @return {Subscriber<T>} A Subscriber wrapping the (partially defined)\n     * Observer represented by the given arguments.\n     */\n    Subscriber.create = function (next, error, complete) {\n        var subscriber = new Subscriber(next, error, complete);\n        subscriber.syncErrorThrowable = false;\n        return subscriber;\n    };\n    /**\n     * The {@link Observer} callback to receive notifications of type `next` from\n     * the Observable, with a value. The Observable may call this method 0 or more\n     * times.\n     * @param {T} [value] The `next` value.\n     * @return {void}\n     */\n    Subscriber.prototype.next = function (value) {\n        if (!this.isStopped) {\n            this._next(value);\n        }\n    };\n    /**\n     * The {@link Observer} callback to receive notifications of type `error` from\n     * the Observable, with an attached {@link Error}. Notifies the Observer that\n     * the Observable has experienced an error condition.\n     * @param {any} [err] The `error` exception.\n     * @return {void}\n     */\n    Subscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            this.isStopped = true;\n            this._error(err);\n        }\n    };\n    /**\n     * The {@link Observer} callback to receive a valueless notification of type\n     * `complete` from the Observable. Notifies the Observer that the Observable\n     * has finished sending push-based notifications.\n     * @return {void}\n     */\n    Subscriber.prototype.complete = function () {\n        if (!this.isStopped) {\n            this.isStopped = true;\n            this._complete();\n        }\n    };\n    Subscriber.prototype.unsubscribe = function () {\n        if (this.closed) {\n            return;\n        }\n        this.isStopped = true;\n        _super.prototype.unsubscribe.call(this);\n    };\n    Subscriber.prototype._next = function (value) {\n        this.destination.next(value);\n    };\n    Subscriber.prototype._error = function (err) {\n        this.destination.error(err);\n        this.unsubscribe();\n    };\n    Subscriber.prototype._complete = function () {\n        this.destination.complete();\n        this.unsubscribe();\n    };\n    Subscriber.prototype._unsubscribeAndRecycle = function () {\n        var _a = this, _parent = _a._parent, _parents = _a._parents;\n        this._parent = null;\n        this._parents = null;\n        this.unsubscribe();\n        this.closed = false;\n        this.isStopped = false;\n        this._parent = _parent;\n        this._parents = _parents;\n        return this;\n    };\n    return Subscriber;\n}(Subscription));\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nvar SafeSubscriber = /*@__PURE__*/ (/*@__PURE__*/ function (_super) {\n    __extends(SafeSubscriber, _super);\n    function SafeSubscriber(_parentSubscriber, observerOrNext, error, complete) {\n        _super.call(this);\n        this._parentSubscriber = _parentSubscriber;\n        var next;\n        var context = this;\n        if (isFunction(observerOrNext)) {\n            next = observerOrNext;\n        }\n        else if (observerOrNext) {\n            next = observerOrNext.next;\n            error = observerOrNext.error;\n            complete = observerOrNext.complete;\n            if (observerOrNext !== emptyObserver) {\n                context = Object.create(observerOrNext);\n                if (isFunction(context.unsubscribe)) {\n                    this.add(context.unsubscribe.bind(context));\n                }\n                context.unsubscribe = this.unsubscribe.bind(this);\n            }\n        }\n        this._context = context;\n        this._next = next;\n        this._error = error;\n        this._complete = complete;\n    }\n    SafeSubscriber.prototype.next = function (value) {\n        if (!this.isStopped && this._next) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (!_parentSubscriber.syncErrorThrowable) {\n                this.__tryOrUnsub(this._next, value);\n            }\n            else if (this.__tryOrSetError(_parentSubscriber, this._next, value)) {\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.error = function (err) {\n        if (!this.isStopped) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (this._error) {\n                if (!_parentSubscriber.syncErrorThrowable) {\n                    this.__tryOrUnsub(this._error, err);\n                    this.unsubscribe();\n                }\n                else {\n                    this.__tryOrSetError(_parentSubscriber, this._error, err);\n                    this.unsubscribe();\n                }\n            }\n            else if (!_parentSubscriber.syncErrorThrowable) {\n                this.unsubscribe();\n                throw err;\n            }\n            else {\n                _parentSubscriber.syncErrorValue = err;\n                _parentSubscriber.syncErrorThrown = true;\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.complete = function () {\n        var _this = this;\n        if (!this.isStopped) {\n            var _parentSubscriber = this._parentSubscriber;\n            if (this._complete) {\n                var wrappedComplete = function () { return _this._complete.call(_this._context); };\n                if (!_parentSubscriber.syncErrorThrowable) {\n                    this.__tryOrUnsub(wrappedComplete);\n                    this.unsubscribe();\n                }\n                else {\n                    this.__tryOrSetError(_parentSubscriber, wrappedComplete);\n                    this.unsubscribe();\n                }\n            }\n            else {\n                this.unsubscribe();\n            }\n        }\n    };\n    SafeSubscriber.prototype.__tryOrUnsub = function (fn, value) {\n        try {\n            fn.call(this._context, value);\n        }\n        catch (err) {\n            this.unsubscribe();\n            throw err;\n        }\n    };\n    SafeSubscriber.prototype.__tryOrSetError = function (parent, fn, value) {\n        try {\n            fn.call(this._context, value);\n        }\n        catch (err) {\n            parent.syncErrorValue = err;\n            parent.syncErrorThrown = true;\n            return true;\n        }\n        return false;\n    };\n    SafeSubscriber.prototype._unsubscribe = function () {\n        var _parentSubscriber = this._parentSubscriber;\n        this._context = null;\n        this._parentSubscriber = null;\n        _parentSubscriber.unsubscribe();\n    };\n    return SafeSubscriber;\n}(Subscriber));\n//# sourceMappingURL=Subscriber.js.map \n","/** PURE_IMPORTS_START .._util_root PURE_IMPORTS_END */\nimport { root } from '../util/root';\nexport function getSymbolObservable(context) {\n    var $$observable;\n    var Symbol = context.Symbol;\n    if (typeof Symbol === 'function') {\n        if (Symbol.observable) {\n            $$observable = Symbol.observable;\n        }\n        else {\n            $$observable = Symbol('observable');\n            Symbol.observable = $$observable;\n        }\n    }\n    else {\n        $$observable = '@@observable';\n    }\n    return $$observable;\n}\nexport var observable = /*@__PURE__*/ getSymbolObservable(root);\n/**\n * @deprecated use observable instead\n */\nexport var $$observable = observable;\n//# sourceMappingURL=observable.js.map \n","/* tslint:disable:no-empty */\n/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nexport function noop() { }\n//# sourceMappingURL=noop.js.map \n","/** PURE_IMPORTS_START ._util_root,._util_toSubscriber,._symbol_observable,._util_pipe PURE_IMPORTS_END */\nimport { root } from './util/root';\nimport { toSubscriber } from './util/toSubscriber';\nimport { observable as Symbol_observable } from './symbol/observable';\nimport { pipeFromArray } from './util/pipe';\n/**\n * A representation of any set of values over any amount of time. This is the most basic building block\n * of RxJS.\n *\n * @class Observable<T>\n */\nexport var Observable = /*@__PURE__*/ (/*@__PURE__*/ function () {\n    /**\n     * @constructor\n     * @param {Function} subscribe the function that is called when the Observable is\n     * initially subscribed to. This function is given a Subscriber, to which new values\n     * can be `next`ed, or an `error` method can be called to raise an error, or\n     * `complete` can be called to notify of a successful completion.\n     */\n    function Observable(subscribe) {\n        this._isScalar = false;\n        if (subscribe) {\n            this._subscribe = subscribe;\n        }\n    }\n    /**\n     * Creates a new Observable, with this Observable as the source, and the passed\n     * operator defined as the new observable's operator.\n     * @method lift\n     * @param {Operator} operator the operator defining the operation to take on the observable\n     * @return {Observable} a new observable with the Operator applied\n     */\n    Observable.prototype.lift = function (operator) {\n        var observable = new Observable();\n        observable.source = this;\n        observable.operator = operator;\n        return observable;\n    };\n    /**\n     * Invokes an execution of an Observable and registers Observer handlers for notifications it will emit.\n     *\n     * <span class=\"informal\">Use it when you have all these Observables, but still nothing is happening.</span>\n     *\n     * `subscribe` is not a regular operator, but a method that calls Observable's internal `subscribe` function. It\n     * might be for example a function that you passed to a {@link create} static factory, but most of the time it is\n     * a library implementation, which defines what and when will be emitted by an Observable. This means that calling\n     * `subscribe` is actually the moment when Observable starts its work, not when it is created, as it is often\n     * thought.\n     *\n     * Apart from starting the execution of an Observable, this method allows you to listen for values\n     * that an Observable emits, as well as for when it completes or errors. You can achieve this in two\n     * following ways.\n     *\n     * The first way is creating an object that implements {@link Observer} interface. It should have methods\n     * defined by that interface, but note that it should be just a regular JavaScript object, which you can create\n     * yourself in any way you want (ES6 class, classic function constructor, object literal etc.). In particular do\n     * not attempt to use any RxJS implementation details to create Observers - you don't need them. Remember also\n     * that your object does not have to implement all methods. If you find yourself creating a method that doesn't\n     * do anything, you can simply omit it. Note however, that if `error` method is not provided, all errors will\n     * be left uncaught.\n     *\n     * The second way is to give up on Observer object altogether and simply provide callback functions in place of its methods.\n     * This means you can provide three functions as arguments to `subscribe`, where first function is equivalent\n     * of a `next` method, second of an `error` method and third of a `complete` method. Just as in case of Observer,\n     * if you do not need to listen for something, you can omit a function, preferably by passing `undefined` or `null`,\n     * since `subscribe` recognizes these functions by where they were placed in function call. When it comes\n     * to `error` function, just as before, if not provided, errors emitted by an Observable will be thrown.\n     *\n     * Whatever style of calling `subscribe` you use, in both cases it returns a Subscription object.\n     * This object allows you to call `unsubscribe` on it, which in turn will stop work that an Observable does and will clean\n     * up all resources that an Observable used. Note that cancelling a subscription will not call `complete` callback\n     * provided to `subscribe` function, which is reserved for a regular completion signal that comes from an Observable.\n     *\n     * Remember that callbacks provided to `subscribe` are not guaranteed to be called asynchronously.\n     * It is an Observable itself that decides when these functions will be called. For example {@link of}\n     * by default emits all its values synchronously. Always check documentation for how given Observable\n     * will behave when subscribed and if its default behavior can be modified with a {@link Scheduler}.\n     *\n     * @example <caption>Subscribe with an Observer</caption>\n     * const sumObserver = {\n     *   sum: 0,\n     *   next(value) {\n     *     console.log('Adding: ' + value);\n     *     this.sum = this.sum + value;\n     *   },\n     *   error() { // We actually could just remove this method,\n     *   },        // since we do not really care about errors right now.\n     *   complete() {\n     *     console.log('Sum equals: ' + this.sum);\n     *   }\n     * };\n     *\n     * Rx.Observable.of(1, 2, 3) // Synchronously emits 1, 2, 3 and then completes.\n     * .subscribe(sumObserver);\n     *\n     * // Logs:\n     * // \"Adding: 1\"\n     * // \"Adding: 2\"\n     * // \"Adding: 3\"\n     * // \"Sum equals: 6\"\n     *\n     *\n     * @example <caption>Subscribe with functions</caption>\n     * let sum = 0;\n     *\n     * Rx.Observable.of(1, 2, 3)\n     * .subscribe(\n     *   function(value) {\n     *     console.log('Adding: ' + value);\n     *     sum = sum + value;\n     *   },\n     *   undefined,\n     *   function() {\n     *     console.log('Sum equals: ' + sum);\n     *   }\n     * );\n     *\n     * // Logs:\n     * // \"Adding: 1\"\n     * // \"Adding: 2\"\n     * // \"Adding: 3\"\n     * // \"Sum equals: 6\"\n     *\n     *\n     * @example <caption>Cancel a subscription</caption>\n     * const subscription = Rx.Observable.interval(1000).subscribe(\n     *   num => console.log(num),\n     *   undefined,\n     *   () => console.log('completed!') // Will not be called, even\n     * );                                // when cancelling subscription\n     *\n     *\n     * setTimeout(() => {\n     *   subscription.unsubscribe();\n     *   console.log('unsubscribed!');\n     * }, 2500);\n     *\n     * // Logs:\n     * // 0 after 1s\n     * // 1 after 2s\n     * // \"unsubscribed!\" after 2.5s\n     *\n     *\n     * @param {Observer|Function} observerOrNext (optional) Either an observer with methods to be called,\n     *  or the first of three possible handlers, which is the handler for each value emitted from the subscribed\n     *  Observable.\n     * @param {Function} error (optional) A handler for a terminal event resulting from an error. If no error handler is provided,\n     *  the error will be thrown as unhandled.\n     * @param {Function} complete (optional) A handler for a terminal event resulting from successful completion.\n     * @return {ISubscription} a subscription reference to the registered handlers\n     * @method subscribe\n     */\n    Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n        var operator = this.operator;\n        var sink = toSubscriber(observerOrNext, error, complete);\n        if (operator) {\n            operator.call(sink, this.source);\n        }\n        else {\n            sink.add(this.source || !sink.syncErrorThrowable ? this._subscribe(sink) : this._trySubscribe(sink));\n        }\n        if (sink.syncErrorThrowable) {\n            sink.syncErrorThrowable = false;\n            if (sink.syncErrorThrown) {\n                throw sink.syncErrorValue;\n            }\n        }\n        return sink;\n    };\n    Observable.prototype._trySubscribe = function (sink) {\n        try {\n            return this._subscribe(sink);\n        }\n        catch (err) {\n            sink.syncErrorThrown = true;\n            sink.syncErrorValue = err;\n            sink.error(err);\n        }\n    };\n    /**\n     * @method forEach\n     * @param {Function} next a handler for each value emitted by the observable\n     * @param {PromiseConstructor} [PromiseCtor] a constructor function used to instantiate the Promise\n     * @return {Promise} a promise that either resolves on observable completion or\n     *  rejects with the handled error\n     */\n    Observable.prototype.forEach = function (next, PromiseCtor) {\n        var _this = this;\n        if (!PromiseCtor) {\n            if (root.Rx && root.Rx.config && root.Rx.config.Promise) {\n                PromiseCtor = root.Rx.config.Promise;\n            }\n            else if (root.Promise) {\n                PromiseCtor = root.Promise;\n            }\n        }\n        if (!PromiseCtor) {\n            throw new Error('no Promise impl found');\n        }\n        return new PromiseCtor(function (resolve, reject) {\n            // Must be declared in a separate statement to avoid a RefernceError when\n            // accessing subscription below in the closure due to Temporal Dead Zone.\n            var subscription;\n            subscription = _this.subscribe(function (value) {\n                if (subscription) {\n                    // if there is a subscription, then we can surmise\n                    // the next handling is asynchronous. Any errors thrown\n                    // need to be rejected explicitly and unsubscribe must be\n                    // called manually\n                    try {\n                        next(value);\n                    }\n                    catch (err) {\n                        reject(err);\n                        subscription.unsubscribe();\n                    }\n                }\n                else {\n                    // if there is NO subscription, then we're getting a nexted\n                    // value synchronously during subscription. We can just call it.\n                    // If it errors, Observable's `subscribe` will ensure the\n                    // unsubscription logic is called, then synchronously rethrow the error.\n                    // After that, Promise will trap the error and send it\n                    // down the rejection path.\n                    next(value);\n                }\n            }, reject, resolve);\n        });\n    };\n    Observable.prototype._subscribe = function (subscriber) {\n        return this.source.subscribe(subscriber);\n    };\n    /**\n     * An interop point defined by the es7-observable spec https://github.com/zenparsing/es-observable\n     * @method Symbol.observable\n     * @return {Observable} this instance of the observable\n     */\n    Observable.prototype[Symbol_observable] = function () {\n        return this;\n    };\n    /* tslint:enable:max-line-length */\n    /**\n     * Used to stitch together functional operators into a chain.\n     * @method pipe\n     * @return {Observable} the Observable result of all of the operators having\n     * been called in the order they were passed in.\n     *\n     * @example\n     *\n     * import { map, filter, scan } from 'rxjs/operators';\n     *\n     * Rx.Observable.interval(1000)\n     *   .pipe(\n     *     filter(x => x % 2 === 0),\n     *     map(x => x + x),\n     *     scan((acc, x) => acc + x)\n     *   )\n     *   .subscribe(x => console.log(x))\n     */\n    Observable.prototype.pipe = function () {\n        var operations = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            operations[_i - 0] = arguments[_i];\n        }\n        if (operations.length === 0) {\n            return this;\n        }\n        return pipeFromArray(operations)(this);\n    };\n    /* tslint:enable:max-line-length */\n    Observable.prototype.toPromise = function (PromiseCtor) {\n        var _this = this;\n        if (!PromiseCtor) {\n            if (root.Rx && root.Rx.config && root.Rx.config.Promise) {\n                PromiseCtor = root.Rx.config.Promise;\n            }\n            else if (root.Promise) {\n                PromiseCtor = root.Promise;\n            }\n        }\n        if (!PromiseCtor) {\n            throw new Error('no Promise impl found');\n        }\n        return new PromiseCtor(function (resolve, reject) {\n            var value;\n            _this.subscribe(function (x) { return value = x; }, function (err) { return reject(err); }, function () { return resolve(value); });\n        });\n    };\n    // HACK: Since TypeScript inherits static properties too, we have to\n    // fight against TypeScript here so Subject can have a different static create signature\n    /**\n     * Creates a new cold Observable by calling the Observable constructor\n     * @static true\n     * @owner Observable\n     * @method create\n     * @param {Function} subscribe? the subscriber function to be passed to the Observable constructor\n     * @return {Observable} a new cold observable\n     */\n    Observable.create = function (subscribe) {\n        return new Observable(subscribe);\n    };\n    return Observable;\n}());\n//# sourceMappingURL=Observable.js.map \n","/** PURE_IMPORTS_START .._Subscriber,.._symbol_rxSubscriber,.._Observer PURE_IMPORTS_END */\nimport { Subscriber } from '../Subscriber';\nimport { rxSubscriber as rxSubscriberSymbol } from '../symbol/rxSubscriber';\nimport { empty as emptyObserver } from '../Observer';\nexport function toSubscriber(nextOrObserver, error, complete) {\n    if (nextOrObserver) {\n        if (nextOrObserver instanceof Subscriber) {\n            return nextOrObserver;\n        }\n        if (nextOrObserver[rxSubscriberSymbol]) {\n            return nextOrObserver[rxSubscriberSymbol]();\n        }\n    }\n    if (!nextOrObserver && !error && !complete) {\n        return new Subscriber(emptyObserver);\n    }\n    return new Subscriber(nextOrObserver, error, complete);\n}\n//# sourceMappingURL=toSubscriber.js.map \n","/** PURE_IMPORTS_START ._noop PURE_IMPORTS_END */\nimport { noop } from './noop';\n/* tslint:enable:max-line-length */\nexport function pipe() {\n    var fns = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        fns[_i - 0] = arguments[_i];\n    }\n    return pipeFromArray(fns);\n}\n/* @internal */\nexport function pipeFromArray(fns) {\n    if (!fns) {\n        return noop;\n    }\n    if (fns.length === 1) {\n        return fns[0];\n    }\n    return function piped(input) {\n        return fns.reduce(function (prev, fn) { return fn(prev); }, input);\n    };\n}\n//# sourceMappingURL=pipe.js.map \n","/** PURE_IMPORTS_START  PURE_IMPORTS_END */\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b)\n        if (b.hasOwnProperty(p))\n            d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\n/**\n * An error thrown when an action is invalid because the object has been\n * unsubscribed.\n *\n * @see {@link Subject}\n * @see {@link BehaviorSubject}\n *\n * @class ObjectUnsubscribedError\n */\nexport var ObjectUnsubscribedError = /*@__PURE__*/ (/*@__PURE__*/ function (_super) {\n    __extends(ObjectUnsubscribedError, _super);\n    function ObjectUnsubscribedError() {\n        var err = _super.call(this, 'object unsubscribed');\n        this.name = err.name = 'ObjectUnsubscribedError';\n        this.stack = err.stack;\n        this.message = err.message;\n    }\n    return ObjectUnsubscribedError;\n}(Error));\n//# sourceMappingURL=ObjectUnsubscribedError.js.map \n","/** PURE_IMPORTS_START ._Subscription PURE_IMPORTS_END */\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b)\n        if (b.hasOwnProperty(p))\n            d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nimport { Subscription } from './Subscription';\n/**\n * We need this JSDoc comment for affecting ESDoc.\n * @ignore\n * @extends {Ignored}\n */\nexport var SubjectSubscription = /*@__PURE__*/ (/*@__PURE__*/ function (_super) {\n    __extends(SubjectSubscription, _super);\n    function SubjectSubscription(subject, subscriber) {\n        _super.call(this);\n        this.subject = subject;\n        this.subscriber = subscriber;\n        this.closed = false;\n    }\n    SubjectSubscription.prototype.unsubscribe = function () {\n        if (this.closed) {\n            return;\n        }\n        this.closed = true;\n        var subject = this.subject;\n        var observers = subject.observers;\n        this.subject = null;\n        if (!observers || observers.length === 0 || subject.isStopped || subject.closed) {\n            return;\n        }\n        var subscriberIndex = observers.indexOf(this.subscriber);\n        if (subscriberIndex !== -1) {\n            observers.splice(subscriberIndex, 1);\n        }\n    };\n    return SubjectSubscription;\n}(Subscription));\n//# sourceMappingURL=SubjectSubscription.js.map \n","/** PURE_IMPORTS_START ._Observable,._Subscriber,._Subscription,._util_ObjectUnsubscribedError,._SubjectSubscription,._symbol_rxSubscriber PURE_IMPORTS_END */\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b)\n        if (b.hasOwnProperty(p))\n            d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nimport { Observable } from './Observable';\nimport { Subscriber } from './Subscriber';\nimport { Subscription } from './Subscription';\nimport { ObjectUnsubscribedError } from './util/ObjectUnsubscribedError';\nimport { SubjectSubscription } from './SubjectSubscription';\nimport { rxSubscriber as rxSubscriberSymbol } from './symbol/rxSubscriber';\n/**\n * @class SubjectSubscriber<T>\n */\nexport var SubjectSubscriber = /*@__PURE__*/ (/*@__PURE__*/ function (_super) {\n    __extends(SubjectSubscriber, _super);\n    function SubjectSubscriber(destination) {\n        _super.call(this, destination);\n        this.destination = destination;\n    }\n    return SubjectSubscriber;\n}(Subscriber));\n/**\n * @class Subject<T>\n */\nexport var Subject = /*@__PURE__*/ (/*@__PURE__*/ function (_super) {\n    __extends(Subject, _super);\n    function Subject() {\n        _super.call(this);\n        this.observers = [];\n        this.closed = false;\n        this.isStopped = false;\n        this.hasError = false;\n        this.thrownError = null;\n    }\n    Subject.prototype[rxSubscriberSymbol] = function () {\n        return new SubjectSubscriber(this);\n    };\n    Subject.prototype.lift = function (operator) {\n        var subject = new AnonymousSubject(this, this);\n        subject.operator = operator;\n        return subject;\n    };\n    Subject.prototype.next = function (value) {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        if (!this.isStopped) {\n            var observers = this.observers;\n            var len = observers.length;\n            var copy = observers.slice();\n            for (var i = 0; i < len; i++) {\n                copy[i].next(value);\n            }\n        }\n    };\n    Subject.prototype.error = function (err) {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        this.hasError = true;\n        this.thrownError = err;\n        this.isStopped = true;\n        var observers = this.observers;\n        var len = observers.length;\n        var copy = observers.slice();\n        for (var i = 0; i < len; i++) {\n            copy[i].error(err);\n        }\n        this.observers.length = 0;\n    };\n    Subject.prototype.complete = function () {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        this.isStopped = true;\n        var observers = this.observers;\n        var len = observers.length;\n        var copy = observers.slice();\n        for (var i = 0; i < len; i++) {\n            copy[i].complete();\n        }\n        this.observers.length = 0;\n    };\n    Subject.prototype.unsubscribe = function () {\n        this.isStopped = true;\n        this.closed = true;\n        this.observers = null;\n    };\n    Subject.prototype._trySubscribe = function (subscriber) {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        else {\n            return _super.prototype._trySubscribe.call(this, subscriber);\n        }\n    };\n    Subject.prototype._subscribe = function (subscriber) {\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        else if (this.hasError) {\n            subscriber.error(this.thrownError);\n            return Subscription.EMPTY;\n        }\n        else if (this.isStopped) {\n            subscriber.complete();\n            return Subscription.EMPTY;\n        }\n        else {\n            this.observers.push(subscriber);\n            return new SubjectSubscription(this, subscriber);\n        }\n    };\n    Subject.prototype.asObservable = function () {\n        var observable = new Observable();\n        observable.source = this;\n        return observable;\n    };\n    Subject.create = function (destination, source) {\n        return new AnonymousSubject(destination, source);\n    };\n    return Subject;\n}(Observable));\n/**\n * @class AnonymousSubject<T>\n */\nexport var AnonymousSubject = /*@__PURE__*/ (/*@__PURE__*/ function (_super) {\n    __extends(AnonymousSubject, _super);\n    function AnonymousSubject(destination, source) {\n        _super.call(this);\n        this.destination = destination;\n        this.source = source;\n    }\n    AnonymousSubject.prototype.next = function (value) {\n        var destination = this.destination;\n        if (destination && destination.next) {\n            destination.next(value);\n        }\n    };\n    AnonymousSubject.prototype.error = function (err) {\n        var destination = this.destination;\n        if (destination && destination.error) {\n            this.destination.error(err);\n        }\n    };\n    AnonymousSubject.prototype.complete = function () {\n        var destination = this.destination;\n        if (destination && destination.complete) {\n            this.destination.complete();\n        }\n    };\n    AnonymousSubject.prototype._subscribe = function (subscriber) {\n        var source = this.source;\n        if (source) {\n            return this.source.subscribe(subscriber);\n        }\n        else {\n            return Subscription.EMPTY;\n        }\n    };\n    return AnonymousSubject;\n}(Subject));\n//# sourceMappingURL=Subject.js.map \n","import { Subject } from \"rxjs/Subject\";\r\nvar WorkerMessenger = (function () {\r\n    function WorkerMessenger() {\r\n        var _this = this;\r\n        this.input_changes_ = new Subject();\r\n        this.model_changes_ = new Subject();\r\n        this.handleMessages = function (event) {\r\n            _this.input_changes_.next(event.data);\r\n        };\r\n        addEventListener(\"message\", this.handleMessages);\r\n        this.model_changes_subscription_ = this.model_changes_.subscribe(function (data) {\r\n            postMessage({ time: self.performance.now(), buffer: data }, [data]);\r\n        });\r\n    }\r\n    ;\r\n    WorkerMessenger.prototype.dispose = function () {\r\n        removeEventListener(\"message\", this.handleMessages);\r\n        this.model_changes_.complete();\r\n        this.input_changes_.complete();\r\n        this.model_changes_subscription_.unsubscribe();\r\n    };\r\n    ;\r\n    WorkerMessenger.prototype.pushChanges = function (buffer) {\r\n        this.model_changes_.next(buffer);\r\n    };\r\n    ;\r\n    WorkerMessenger.prototype.getInputs = function () {\r\n        return this.input_changes_.asObservable();\r\n    };\r\n    ;\r\n    return WorkerMessenger;\r\n}());\r\nexport { WorkerMessenger };\r\n;\r\n//# sourceMappingURL=worker-messenger.js.map","var GameState = (function () {\r\n    function GameState(camera_) {\r\n        this.camera_ = camera_;\r\n        this.game_objects_ = [];\r\n    }\r\n    ;\r\n    GameState.prototype.addNewObject = function (object) {\r\n        this.game_objects_.push(object);\r\n    };\r\n    ;\r\n    GameState.prototype.removeObject = function (index) {\r\n    };\r\n    ;\r\n    GameState.prototype.updateObjects = function (dt, inputs) {\r\n        var bufferLength = (this.game_objects_.length + 2) * 16 * 4;\r\n        var buffer = new ArrayBuffer(bufferLength);\r\n        var view = new Float32Array(buffer, 0, 16);\r\n        var projection = new Float32Array(buffer, 64, 16);\r\n        this.camera_.update(inputs);\r\n        view.set(this.camera_.view);\r\n        projection.set(this.camera_.projection);\r\n        this.game_objects_.forEach(function (object, i) {\r\n            var matrix = new Float32Array(buffer, (i + 2) * 64, 16);\r\n            matrix.set(object.update(dt, inputs));\r\n        });\r\n        return buffer;\r\n    };\r\n    ;\r\n    return GameState;\r\n}());\r\nexport { GameState };\r\n//# sourceMappingURL=game-state.js.map","import { Transform } from \"./transform\";\r\nimport { Vec3 } from \"./vec3\";\r\nvar Camera = (function () {\r\n    function Camera() {\r\n        this.minZoom = -3.0;\r\n        this.maxZoom = -6.0;\r\n        this.zoomSpeed = 0.2;\r\n        this.near_ = 0.1;\r\n        this.far_ = 100.0;\r\n        this.pMatrix_ = new Float32Array(16);\r\n        this.vMatrix_ = new Float32Array(16);\r\n        this.vFieldOfView_ = 60.0 * Math.PI / 180;\r\n        this.transform_ = new Transform();\r\n        var transform = new Vec3(0.0, 0.0, -3.5);\r\n        this.transform_.translate(transform);\r\n        this.vMatrix_ = this.transform_.transform;\r\n    }\r\n    ;\r\n    Object.defineProperty(Camera.prototype, \"view\", {\r\n        get: function () {\r\n            return this.vMatrix_;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ;\r\n    Object.defineProperty(Camera.prototype, \"projection\", {\r\n        get: function () {\r\n            this.calculateFrustrum();\r\n            return this.pMatrix_;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    ;\r\n    Camera.prototype.update = function (inputs) {\r\n        var zoom = -1 * inputs.wheel * this.zoomSpeed;\r\n        var currentPosition = this.vMatrix_[14];\r\n        zoom = (zoom + currentPosition >= this.minZoom) ? 0.0 : ((zoom + currentPosition <= this.maxZoom) ? 0.0 : zoom);\r\n        var transform = new Vec3(0.0, 0.0, zoom);\r\n        this.transform_.translate(transform);\r\n        this.vMatrix_ = this.transform_.transform;\r\n        this.aspect_ = inputs.aspect;\r\n    };\r\n    ;\r\n    Camera.prototype.calculateFrustrum = function () {\r\n        var f = Math.tan(0.5 * (Math.PI - this.vFieldOfView_));\r\n        var depth = 1.0 / (this.near_ - this.far_);\r\n        this.pMatrix_[0] = f / this.aspect_;\r\n        this.pMatrix_[5] = f;\r\n        this.pMatrix_[10] = (this.near_ + this.far_) * depth;\r\n        this.pMatrix_[11] = -1.0;\r\n        this.pMatrix_[14] = 2.0 * (this.near_ * this.far_) * depth;\r\n    };\r\n    ;\r\n    return Camera;\r\n}());\r\nexport { Camera };\r\n//# sourceMappingURL=game-camera.js.map","import { GameEngine } from \"./game-engine\";\r\nimport { WorkerMessenger } from \"./worker-messenger\";\r\nimport { GameState } from \"./game-state\";\r\nimport { Camera } from \"./game-camera\";\r\nvar messenger = new WorkerMessenger();\r\nvar camera = new Camera();\r\nvar gameState = new GameState(camera);\r\nvar engine = new GameEngine(messenger, gameState);\r\nvar interval_token;\r\n(function () {\r\n    engine.Start();\r\n    var dt = 20;\r\n    interval_token = self.setInterval(function () {\r\n        engine.Update(dt);\r\n    }, dt);\r\n})();\r\n//# sourceMappingURL=main.js.map"],"names":["Vec3","x","y","z","this","vector_","Float32Array","Object","defineProperty","prototype","get","set","value","enumerable","configurable","Math","sqrt","pow","dot","a","b","cross","out","normalise","length","factor","scale","add","subtract","s","copy","i","array","GameObject","transform_","isActive","update","dt","inputs","left","dx","delta","rotate","transform","markInactive","Quaternion","axis","angle","phi","PI","v_","sin","w_","cos","v","w","conjugate","c","p","multiply","q","r","Mat4","matrix_","identity","a11","a12","a13","a14","a21","a22","a23","a24","a31","a32","a33","a34","a41","a42","a43","a44","b1","b2","b3","b4","wx","wy","wz","xx","yy","zz","xy","xz","yz","translate","t","Transform","position_","scale_","orientation_","vec","InputState","GameEngine","messenger_","gameState_","_this","current_inputs_","inputs_subscription","getInputs","subscribe","Start","testObject","addNewObject","Update","state","updateObjects","pushChanges","dispose","unsubscribe","__window","window","__self","self","WorkerGlobalScope","__global","global","_root","isFunction","isArray","Array","tryCatchTarget","errorObject","e","tryCatcher","apply","arguments","tryCatch","fn","__extends","d","hasOwnProperty","__","constructor","create","UnsubscriptionError","_super","errors","call","err","Error","map","toString","join","name","stack","message","Subscription","closed","_parent","_parents","_subscriptions","_unsubscribe","empty","hasErrors","index","len","remove","flattenUnsubscriptionErrors","sub","concat","push","teardown","EMPTY","subscription","_addParent","tmp","subscriptions","subscriptionIndex","indexOf","splice","parent","reduce","errs","next","error","complete","Symbol","root","rxSubscriber","for","Subscriber","destinationOrNext","syncErrorValue","syncErrorThrown","syncErrorThrowable","isStopped","destination","emptyObserver","SafeSubscriber","rxSubscriberSymbol","subscriber","_next","_error","_complete","_unsubscribeAndRecycle","_parentSubscriber","observerOrNext","context","bind","_context","__tryOrSetError","__tryOrUnsub","wrappedComplete","observable","$$observable","getSymbolObservable","noop","Observable","_isScalar","_subscribe","lift","operator","source","sink","nextOrObserver","toSubscriber","_trySubscribe","forEach","PromiseCtor","Rx","config","Promise","resolve","reject","Symbol_observable","pipe","fns","operations","_i","input","prev","toPromise","ObjectUnsubscribedError","SubjectSubscription","subject","observers","subscriberIndex","SubjectSubscriber","Subject","hasError","thrownError","AnonymousSubject","slice","asObservable","WorkerMessenger","input_changes_","model_changes_","handleMessages","event","data","addEventListener","model_changes_subscription_","postMessage","time","performance","now","buffer","removeEventListener","GameState","camera_","game_objects_","object","removeObject","bufferLength","ArrayBuffer","view","projection","Camera","minZoom","maxZoom","zoomSpeed","near_","far_","pMatrix_","vMatrix_","vFieldOfView_","calculateFrustrum","zoom","wheel","currentPosition","aspect_","aspect","f","tan","depth","engine","setInterval"],"mappings":"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"}